(()=>{var e={};e.id=702,e.ids=[702],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},77454:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>d,routeModule:()=>m,tree:()=>o}),t(69521),t(11506),t(35866);var r=t(23191),a=t(88716),l=t(37922),n=t.n(l),i=t(95231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let o=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,69521)),"/Users/vincent/Desktop/social club web/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,11506)),"/Users/vincent/Desktop/social club web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/vincent/Desktop/social club web/app/dashboard/page.tsx"],x="/dashboard/page",h={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},11227:(e,s,t)=>{Promise.resolve().then(t.bind(t,79096))},44620:()=>{},55976:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},79096:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>C});var r=t(10326),a=t(17577),l=t(35047),n=t(4891),i=t(39730),c=t(79635),o=t(76557);let d=(0,o.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var x=t(33734),h=t(67427);let m=(0,o.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var u=t(37358);function p({user:e}){let[s,t]=(0,a.useState)(0);return(0,r.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-lg overflow-hidden card-hover",children:[(0,r.jsxs)("div",{className:"relative h-96 bg-gradient-to-br from-red-100 to-pink-100",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent z-10"}),e.photos.length>1&&r.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-20",children:r.jsx("div",{className:"flex space-x-2",children:e.photos.map((e,t)=>r.jsx("div",{className:`w-2 h-2 rounded-full ${t===s?"bg-white":"bg-white/50"}`},t))})}),e.photos.length>1&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:()=>{t(s=>0===s?e.photos.length-1:s-1)},className:"absolute left-4 top-1/2 transform -translate-y-1/2 z-20 w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:"‹"}),r.jsx("button",{onClick:()=>{t(s=>s===e.photos.length-1?0:s+1)},className:"absolute right-4 top-1/2 transform -translate-y-1/2 z-20 w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:"›"})]}),r.jsx("div",{className:"absolute top-4 right-4 z-20",children:(0,r.jsxs)("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full ${e.isOnline?"bg-green-500 text-white":"bg-gray-500 text-white"}`,children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${e.isOnline?"bg-white":"bg-gray-300"}`}),r.jsx("span",{className:"text-sm font-medium",children:e.isOnline?"在线":"离线"})]})}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 z-10",children:(0,r.jsxs)("div",{className:"flex items-end justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-white mb-1",children:[e.name,", ",e.age]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-white/90 mb-2",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:e.location})]})]}),r.jsx("div",{className:"flex space-x-2",children:r.jsx("button",{className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:r.jsx(h.Z,{className:"h-5 w-5"})})})]})})]}),(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("p",{className:"text-gray-700 mb-4 leading-relaxed",children:e.bio}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"兴趣爱好"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:e.interests.map((e,s)=>r.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-700 text-sm rounded-full",children:e},s))})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(u.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:[e.age,"岁"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{children:e.location})]})]})]})]})}let g=(0,o.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),f=(0,o.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),b=(0,o.Z)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),j=(0,o.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);function y({matchedUsers:e,onClose:s}){let[t,l]=(0,a.useState)(null),[n,i]=(0,a.useState)([]),[c,o]=(0,a.useState)(""),d=(0,a.useRef)(null),x=()=>{if(c.trim()&&t){let e={id:Date.now().toString(),senderId:"current-user",receiverId:t.id,content:c.trim(),timestamp:new Date,type:"text"};i(s=>[...s,e]),o(""),setTimeout(()=>{let e={id:(Date.now()+1).toString(),senderId:t.id,receiverId:"current-user",content:"收到你的消息了！我正在回复...",timestamp:new Date,type:"text"};i(s=>[...s,e])},2e3)}},h=e=>e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"聊天"}),r.jsx("button",{onClick:s,className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx(g,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[r.jsx("div",{className:"w-80 border-r bg-gray-50",children:(0,r.jsxs)("div",{className:"p-4",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"匹配的用户"}),r.jsx("div",{className:"space-y-2",children:e.map(e=>r.jsx("div",{onClick:()=>l(e),className:`p-3 rounded-lg cursor-pointer transition-colors ${t?.id===e.id?"bg-red-100 border-red-200":"bg-white hover:bg-gray-100"}`,children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-red-200 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-red-600 font-medium",children:e.name.charAt(0)})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h5",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.age,"岁 \xb7 ",e.location]})]}),e.isOnline&&r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"})]})},e.id))})]})}),r.jsx("div",{className:"flex-1 flex flex-col",children:t?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"p-4 border-b bg-white",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-red-200 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-red-600 font-medium",children:t.name.charAt(0)})}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),r.jsx("p",{className:"text-sm text-gray-500",children:t.isOnline?"在线":"离线"})]})]})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.map(e=>r.jsx("div",{className:`flex ${"current-user"===e.senderId?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${"current-user"===e.senderId?"bg-red-500 text-white":"bg-gray-200 text-gray-900"}`,children:[r.jsx("p",{className:"text-sm",children:e.content}),r.jsx("p",{className:`text-xs mt-1 ${"current-user"===e.senderId?"text-red-100":"text-gray-500"}`,children:h(e.timestamp)})]})},e.id)),r.jsx("div",{ref:d})]}),r.jsx("div",{className:"p-4 border-t bg-white",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx(f,{className:"h-5 w-5"})}),r.jsx("div",{className:"flex-1 relative",children:r.jsx("input",{type:"text",value:c,onChange:e=>o(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),x())},placeholder:"输入消息...",className:"w-full px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"})}),r.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx(b,{className:"h-5 w-5"})}),r.jsx("button",{onClick:x,disabled:!c.trim(),className:"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(j,{className:"h-5 w-5"})})]})})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("span",{className:"text-gray-500 text-2xl",children:"\uD83D\uDCAC"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"选择聊天对象"}),r.jsx("p",{className:"text-gray-500",children:"从左侧选择一个匹配的用户开始聊天"})]})})})]})]})})}let v=(0,o.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),N=(0,o.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),w=(0,o.Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),k=(e,s="")=>{try{let t=localStorage.getItem("user");if(t&&e){let r={...JSON.parse(t),...e};return localStorage.setItem("user",JSON.stringify(r)),console.log(`${s}: localStorage中的用户数据已更新:`,r),r}}catch(e){console.error(`${s}: 更新localStorage失败:`,e)}return null};function S({onClose:e}){let[s,t]=(0,a.useState)(!1),[l,n]=(0,a.useState)(!0),[i,c]=(0,a.useState)(null),[o,d]=(0,a.useState)({}),x=async()=>{if(i)try{let e=localStorage.getItem("token");if(!e)return;console.log("前端发送的数据:",o),console.log("bio字段值:",o.bio);let s=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(o)});if(s.ok){let r=await s.json();if(r.success){console.log("保存成功，重新获取用户资料...");let s=await fetch(`/api/user/profile?t=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`,"Cache-Control":"no-cache",Pragma:"no-cache"}});if(s.ok){let e=await s.json();e.success&&(console.log("获取到的最新数据:",e.user),c(e.user),d(e.user),k(e.user,"ProfileModal保存"))}t(!1),alert("保存成功！")}else alert(r.error||"保存失败")}else alert("保存失败，请稍后重试")}catch(e){console.error("保存用户资料失败:",e),alert("保存失败，请稍后重试")}},h=e=>{if(e.trim()){let s=o.interests||[];s.includes(e.trim())||d(t=>({...t,interests:[...s,e.trim()]}))}},m=e=>{let s=o.interests||[];d(t=>({...t,interests:s.filter((s,t)=>t!==e)}))};return l||l?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-500 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"加载中..."})]})})}):i?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"个人资料"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:x,className:"flex items-center space-x-1 px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[r.jsx(v,{className:"h-4 w-4"}),r.jsx("span",{children:"保存"})]}),r.jsx("button",{onClick:()=>{i&&d(i),t(!1)},className:"px-3 py-1 text-gray-600 hover:text-gray-800 transition-colors",children:"取消"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>t(!0),className:"flex items-center space-x-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[r.jsx(N,{className:"h-4 w-4"}),r.jsx("span",{children:"编辑"})]}),r.jsx("button",{onClick:async()=>{let e=localStorage.getItem("token");if(!e)return;let s=await fetch(`/api/user/profile?t=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`,"Cache-Control":"no-cache",Pragma:"no-cache"}});if(s.ok){let e=await s.json();e.success&&(c(e.user),d(e.user),k(e.user,"ProfileModal刷新"),alert("数据已刷新！"))}},className:"flex items-center space-x-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:r.jsx("span",{children:"刷新"})})]}),r.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx(g,{className:"h-5 w-5"})})]})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[r.jsx("div",{className:"text-center",children:(0,r.jsxs)("div",{className:"relative inline-block",children:[r.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-red-100 to-pink-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("span",{className:"text-4xl font-bold text-red-500",children:i.name.charAt(0)})}),s&&r.jsx("button",{className:"absolute bottom-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors",children:r.jsx(w,{className:"h-4 w-4"})})]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:"基本信息"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"姓名"}),s?r.jsx("input",{type:"text",value:o.name||"",onChange:e=>d(s=>({...s,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"}):r.jsx("p",{className:"text-gray-900",children:i.name})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"年龄"}),(0,r.jsxs)("p",{className:"text-gray-900",children:[(e=>{let s=new Date,t=new Date(e),r=s.getFullYear()-t.getFullYear(),a=s.getMonth()-t.getMonth();return(a<0||0===a&&s.getDate()<t.getDate())&&r--,r})(i.birth_date),"岁"]})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"所在地"}),s?r.jsx("input",{type:"text",value:o.location||"",onChange:e=>d(s=>({...s,location:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"}):r.jsx("p",{className:"text-gray-900",children:i.location||"未设置"})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"个人简介"}),s?r.jsx("textarea",{value:o.bio||"",onChange:e=>d(s=>({...s,bio:e.target.value})),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",placeholder:"介绍一下你自己..."}):r.jsx("p",{className:"text-gray-700 leading-relaxed",children:i.bio||"这个人很神秘..."})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"兴趣爱好"}),s?(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"flex flex-wrap gap-2",children:(o.interests||[]).map((e,s)=>(0,r.jsxs)("span",{className:"flex items-center space-x-1 px-3 py-1 bg-red-100 text-red-700 text-sm rounded-full",children:[r.jsx("span",{children:e}),r.jsx("button",{onClick:()=>m(s),className:"text-red-500 hover:text-red-700",children:"\xd7"})]},s))}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("input",{type:"text",placeholder:"添加兴趣...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent",onKeyPress:e=>{"Enter"===e.key&&(h(e.currentTarget.value),e.currentTarget.value="")}}),r.jsx("button",{onClick:e=>{let s=e.currentTarget.previousElementSibling;h(s.value),s.value=""},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"添加"})]})]}):r.jsx("div",{className:"flex flex-wrap gap-2",children:(i.interests||[]).map((e,s)=>r.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-700 text-sm rounded-full",children:e},s))})]}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"隐私设置"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:"个人资料可见性"}),r.jsx("p",{className:"text-sm text-gray-500",children:"控制谁可以看到你的个人资料"})]}),(0,r.jsxs)("select",{className:"px-3 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[r.jsx("option",{children:"所有人"}),r.jsx("option",{children:"仅匹配用户"}),r.jsx("option",{children:"仅好友"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:"在线状态"}),r.jsx("p",{className:"text-sm text-gray-500",children:"显示你的在线状态"})]}),(0,r.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",defaultChecked:!0,className:"sr-only peer"}),r.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-500"})]})]})]})]})]})]})}):r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-gray-600",children:"无法加载用户资料"}),r.jsx("button",{onClick:e,className:"mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"关闭"})]})})})}function C(){let e=(0,l.useRouter)(),[s,t]=(0,a.useState)(!0),[o,m]=(0,a.useState)(0),[u,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[j,v]=(0,a.useState)([]),[N,w]=(0,a.useState)(null),[C,P]=(0,a.useState)([]),z=async()=>{let e=C[o];if(e){try{let s=localStorage.getItem("token");if(!s)return;let t=await fetch("/api/user/matches",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({matchedUserId:e.id,action:"like"})});if(t.ok){let s=await t.json();s.success&&s.isMatch&&(v(s=>[...s,e]),alert(`恭喜！你和${e.name}匹配成功了！`))}}catch(e){console.error("处理喜欢失败:",e)}m(e=>e+1)}},D=async()=>{let e=C[o];if(e){try{let s=localStorage.getItem("token");if(!s)return;await fetch("/api/user/matches",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({matchedUserId:e.id,action:"pass"})})}catch(e){console.error("处理跳过失败:",e)}m(e=>e+1)}},$=async()=>{let e=C[o];if(e){try{let s=localStorage.getItem("token");if(!s)return;let t=await fetch("/api/user/matches",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({matchedUserId:e.id,action:"super_like"})});if(t.ok){let s=await t.json();s.success&&s.isMatch&&(v(s=>[...s,e]),alert(`恭喜！你和${e.name}匹配成功了！`))}}catch(e){console.error("处理超级喜欢失败:",e)}m(e=>e+1)}};if(s)return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-100 via-purple-50 to-blue-100 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-500 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"加载中..."})]})});let I=C[o];return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-100 via-purple-50 to-blue-100",children:[r.jsx("nav",{className:"bg-white shadow-lg",children:r.jsx("div",{className:"max-w-6xl mx-auto px-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[r.jsx("div",{className:"flex items-center space-x-4",children:r.jsx("h1",{className:"text-2xl font-bold text-red-500",children:"社交俱乐部"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("button",{onClick:()=>g(!0),className:"p-2 text-gray-600 hover:text-red-500 transition-colors",children:r.jsx(i.Z,{size:24})}),r.jsx("button",{onClick:()=>b(!0),className:"p-2 text-gray-600 hover:text-red-500 transition-colors",children:r.jsx(c.Z,{size:24})}),r.jsx("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),e.push("/")},className:"p-2 text-gray-600 hover:text-red-500 transition-colors",children:r.jsx(d,{size:24})})]})]})})}),r.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:I?(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx(p,{user:I}),(0,r.jsxs)("div",{className:"flex justify-center space-x-8 mt-8",children:[r.jsx(n.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:D,className:"w-16 h-16 bg-gray-400 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-gray-500 transition-colors",children:"✕"}),r.jsx(n.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:$,className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-blue-600 transition-colors",children:r.jsx(x.Z,{size:24})}),r.jsx(n.E.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:z,className:"w-16 h-16 bg-red-500 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-red-600 transition-colors",children:r.jsx(h.Z,{size:24})})]})]}):(0,r.jsxs)("div",{className:"text-center py-20",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-700 mb-4",children:"没有更多推荐了"}),r.jsx("p",{className:"text-gray-500",children:"稍后再来看看吧！"})]})}),u&&r.jsx(y,{matchedUsers:j,onClose:()=>g(!1)}),f&&r.jsx(S,{onClose:()=>{b(!1),(async()=>{try{let e=localStorage.getItem("token");if(!e)return;console.log("Dashboard: 重新获取用户资料...");let s=await fetch(`/api/user/profile?t=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`,"Cache-Control":"no-cache",Pragma:"no-cache"}});if(s.ok){let e=await s.json();e.success&&(console.log("Dashboard: 获取到最新用户资料:",e.user),w(e.user),k(e.user,"Dashboard关闭ProfileModal"))}}catch(e){console.error("Dashboard: 重新获取用户资料失败:",e)}})()}})]})}},69521:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/vincent/Desktop/social club web/app/dashboard/page.tsx#default`)},11506:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l,metadata:()=>a});var r=t(19510);t(67272);let a={title:"社交俱乐部 - 找到你的另一半",description:"现代化的网页版交友软件，帮助你找到真正的爱情"};function l({children:e}){return r.jsx("html",{lang:"zh-CN",children:r.jsx("body",{className:"bg-gray-50 min-h-screen",children:e})})}},67272:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,471,604],()=>t(77454));module.exports=r})();